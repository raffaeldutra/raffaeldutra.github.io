# Rafael Dutra
sudo: required

services:
  - docker

before_install:
  - mkdir -p public/resume

script:
  - docker build --no-cache -t raffaeldutra/gohugo .
  - docker run -it -v $(pwd):/src -v $(pwd)/public:/src/public raffaeldutra/gohugo
  - curl
    --form input_files[]=@content/page/cv/resume.md
    --form from=markdown
    --form to=pdf
    http://c.docverter.com/convert > public/resume/rafael-dutra-resume.pdf
  - curl
    --form input_files[]=@content/page/cv/resume.ptbr.md
    --form from=markdown
    --form to=pdf
    http://c.docverter.com/convert > public/resume/rafael-dutra-resume.ptbr.pdf

deploy:
  name: "rafaeldutra.me deployment"
  provider: pages
  local_dir: public
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  keep_history: true
  verbose: true
  target_branch: master
  on:
    branch: develop
  fqdn: rafaeldutra.me
